var $=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},W=class{static fromArray(t,r){let n=r||new x;for(let s=t.length-1;s>=0;--s)n=new tt(t[s],n);return n}[Symbol.iterator](){return new Zr(this)}toArray(){return[...this]}atLeastLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return r!==void 0}hasLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return t===-1&&r instanceof x}countLength(){let t=this,r=0;for(;t;)t=t.tail,r++;return r-1}};function p(e,t){return new tt(e,t)}function l(e,t){return W.fromArray(e,t)}var Zr=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof x)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},x=class extends W{};var tt=class extends W{constructor(t,r){super(),this.head=t,this.tail=r}};var mt=class{bitSize;byteSize;bitOffset;rawBuffer;constructor(t,r,n){if(!(t instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=r??t.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=n??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(t.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=t}byteAt(t){if(!(t<0||t>=this.byteSize))return Dt(this.rawBuffer,this.bitOffset,t)}equals(t){if(this.bitSize!==t.bitSize)return!1;let r=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&t.bitOffset===0){for(let s=0;s<r;s++)if(this.rawBuffer[s]!==t.rawBuffer[s])return!1;let n=this.bitSize%8;if(n){let s=8-n;if(this.rawBuffer[r]>>s!==t.rawBuffer[r]>>s)return!1}}else{for(let s=0;s<r;s++){let i=Dt(this.rawBuffer,this.bitOffset,s),o=Dt(t.rawBuffer,t.bitOffset,s);if(i!==o)return!1}let n=this.bitSize%8;if(n){let s=Dt(this.rawBuffer,this.bitOffset,r),i=Dt(t.rawBuffer,t.bitOffset,r),o=8-n;if(s>>o!==i>>o)return!1}}return!0}get buffer(){if(Ws("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(Ws("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}};function Dt(e,t,r){if(t===0)return e[r]??0;{let n=e[r]<<t&255,s=e[r+1]>>8-t;return n|s}}var Ot=class{constructor(t){this.value=t}},Ns={};function Ws(e,t){Ns[e]||(console.warn(`Deprecated BitArray.${e} property used in JavaScript FFI code. ${t}.`),Ns[e]=!0)}var _t=class e extends ${static isResult(t){return t instanceof e}},d=class extends _t{constructor(t){super(),this[0]=t}isOk(){return!0}};var h=class extends _t{constructor(t){super(),this[0]=t}isOk(){return!1}};function L(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),s=r.pop();if(n===s)continue;if(!Fs(n)||!Fs(s)||!wl(n,s)||dl(n,s)||$l(n,s)||ml(n,s)||_l(n,s)||xl(n,s)||hl(n,s))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(s))continue;return!1}catch{}let[u,a]=fl(n),c=u(n),f=u(s);if(c.length!==f.length)return!1;for(let m of c)r.push(a(n,m),a(s,m))}return!0}function fl(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function dl(e,t){return e instanceof Date&&(e>t||e<t)}function $l(e,t){return!(e instanceof mt)&&e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function ml(e,t){return Array.isArray(e)&&e.length!==t.length}function _l(e,t){return e instanceof Map&&e.size!==t.size}function xl(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function hl(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function Fs(e){return typeof e=="object"&&e!==null}function wl(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function qt(e,t){return t===0?0:e%t}function Lt(e,t){return Math.trunc(pr(e,t))}function pr(e,t){return t===0?0:e/t}function fr(e,t,r,n,s,i,o){let u=new globalThis.Error(i);u.gleam_error=e,u.file=t,u.module=r,u.line=n,u.function=s,u.fn=s;for(let a in o)u[a]=o[a];return u}var w=class extends ${constructor(t){super(),this[0]=t}};var z=class extends ${};function gl(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head;e=r.tail,t=p(s,n)}}}function yl(e){return gl(e,l([]))}function en(e,t){if(e instanceof w){let r=e[0];return new d(r)}else return new h(t)}function re(e){if(e instanceof d){let t=e[0];return new w(t)}else return new z}function xt(e,t){return e instanceof w?e[0]:t}function ht(e,t){if(e instanceof w){let r=e[0];return new w(t(r))}else return e}function bl(e,t){for(;;){let r=e,n=t;if(r instanceof x)return yl(n);{let s=r.head;if(s instanceof w){let i=r.tail,o=s[0];e=i,t=p(o,n)}else e=r.tail,t=n}}}function Oe(e){return bl(e,l([]))}var Ps=new WeakMap,tn=new DataView(new ArrayBuffer(8)),rn=0;function nn(e){let t=Ps.get(e);if(t!==void 0)return t;let r=rn++;return rn===2147483647&&(rn=0),Ps.set(e,r),r}function sn(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function ln(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Xs(e){tn.setFloat64(0,e);let t=tn.getInt32(0),r=tn.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function vl(e){return ln(e.toString())}function kl(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return nn(e);if(e instanceof Date)return Xs(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+ae(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+ae(n)|0});else if(e instanceof Map)e.forEach((n,s)=>{r=r+sn(ae(n),ae(s))|0});else{let n=Object.keys(e);for(let s=0;s<n.length;s++){let i=n[s],o=e[i];r=r+sn(ae(o),ln(i))|0}}return r}function ae(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Xs(e);case"string":return ln(e);case"bigint":return vl(e);case"object":return kl(e);case"symbol":return nn(e);case"function":return nn(e);default:return 0}}var Re=5,un=Math.pow(2,Re),El=un-1,Rl=un/2,Sl=un/4,V=0,Ee=1,ne=2,rt=3,an={type:ne,bitmap:0,array:[]};function Ut(e,t){return e>>>t&El}function $r(e,t){return 1<<Ut(e,t)}function Cl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function cn(e,t){return Cl(e&t-1)}function ce(e,t,r){let n=e.length,s=new Array(n);for(let i=0;i<n;++i)s[i]=e[i];return s[t]=r,s}function Al(e,t,r){let n=e.length,s=new Array(n+1),i=0,o=0;for(;i<t;)s[o++]=e[i++];for(s[o++]=r;i<n;)s[o++]=e[i++];return s}function on(e,t){let r=e.length,n=new Array(r-1),s=0,i=0;for(;s<t;)n[i++]=e[s++];for(++s;s<r;)n[i++]=e[s++];return n}function Gs(e,t,r,n,s,i){let o=ae(t);if(o===n)return{type:rt,hash:o,array:[{type:V,k:t,v:r},{type:V,k:s,v:i}]};let u={val:!1};return Nt(pn(an,e,o,t,r,u),e,n,s,i,u)}function Nt(e,t,r,n,s,i){switch(e.type){case Ee:return zl(e,t,r,n,s,i);case ne:return pn(e,t,r,n,s,i);case rt:return Tl(e,t,r,n,s,i)}}function zl(e,t,r,n,s,i){let o=Ut(r,t),u=e.array[o];if(u===void 0)return i.val=!0,{type:Ee,size:e.size+1,array:ce(e.array,o,{type:V,k:n,v:s})};if(u.type===V)return L(n,u.k)?s===u.v?e:{type:Ee,size:e.size,array:ce(e.array,o,{type:V,k:n,v:s})}:(i.val=!0,{type:Ee,size:e.size,array:ce(e.array,o,Gs(t+Re,u.k,u.v,r,n,s))});let a=Nt(u,t+Re,r,n,s,i);return a===u?e:{type:Ee,size:e.size,array:ce(e.array,o,a)}}function pn(e,t,r,n,s,i){let o=$r(r,t),u=cn(e.bitmap,o);if(e.bitmap&o){let a=e.array[u];if(a.type!==V){let f=Nt(a,t+Re,r,n,s,i);return f===a?e:{type:ne,bitmap:e.bitmap,array:ce(e.array,u,f)}}let c=a.k;return L(n,c)?s===a.v?e:{type:ne,bitmap:e.bitmap,array:ce(e.array,u,{type:V,k:n,v:s})}:(i.val=!0,{type:ne,bitmap:e.bitmap,array:ce(e.array,u,Gs(t+Re,c,a.v,r,n,s))})}else{let a=e.array.length;if(a>=Rl){let c=new Array(32),f=Ut(r,t);c[f]=pn(an,t+Re,r,n,s,i);let m=0,g=e.bitmap;for(let y=0;y<32;y++){if(g&1){let v=e.array[m++];c[y]=v}g=g>>>1}return{type:Ee,size:a+1,array:c}}else{let c=Al(e.array,u,{type:V,k:n,v:s});return i.val=!0,{type:ne,bitmap:e.bitmap|o,array:c}}}}function Tl(e,t,r,n,s,i){if(r===e.hash){let o=fn(e,n);if(o!==-1)return e.array[o].v===s?e:{type:rt,hash:r,array:ce(e.array,o,{type:V,k:n,v:s})};let u=e.array.length;return i.val=!0,{type:rt,hash:r,array:ce(e.array,u,{type:V,k:n,v:s})}}return Nt({type:ne,bitmap:$r(e.hash,t),array:[e]},t,r,n,s,i)}function fn(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(L(t,e.array[n].k))return n;return-1}function dr(e,t,r,n){switch(e.type){case Ee:return Ml(e,t,r,n);case ne:return jl(e,t,r,n);case rt:return Il(e,n)}}function Ml(e,t,r,n){let s=Ut(r,t),i=e.array[s];if(i!==void 0){if(i.type!==V)return dr(i,t+Re,r,n);if(L(n,i.k))return i}}function jl(e,t,r,n){let s=$r(r,t);if(!(e.bitmap&s))return;let i=cn(e.bitmap,s),o=e.array[i];if(o.type!==V)return dr(o,t+Re,r,n);if(L(n,o.k))return o}function Il(e,t){let r=fn(e,t);if(!(r<0))return e.array[r]}function dn(e,t,r,n){switch(e.type){case Ee:return Bl(e,t,r,n);case ne:return Dl(e,t,r,n);case rt:return Ol(e,n)}}function Bl(e,t,r,n){let s=Ut(r,t),i=e.array[s];if(i===void 0)return e;let o;if(i.type===V){if(!L(i.k,n))return e}else if(o=dn(i,t+Re,r,n),o===i)return e;if(o===void 0){if(e.size<=Sl){let u=e.array,a=new Array(e.size-1),c=0,f=0,m=0;for(;c<s;){let g=u[c];g!==void 0&&(a[f]=g,m|=1<<c,++f),++c}for(++c;c<u.length;){let g=u[c];g!==void 0&&(a[f]=g,m|=1<<c,++f),++c}return{type:ne,bitmap:m,array:a}}return{type:Ee,size:e.size-1,array:ce(e.array,s,o)}}return{type:Ee,size:e.size,array:ce(e.array,s,o)}}function Dl(e,t,r,n){let s=$r(r,t);if(!(e.bitmap&s))return e;let i=cn(e.bitmap,s),o=e.array[i];if(o.type!==V){let u=dn(o,t+Re,r,n);return u===o?e:u!==void 0?{type:ne,bitmap:e.bitmap,array:ce(e.array,i,u)}:e.bitmap===s?void 0:{type:ne,bitmap:e.bitmap^s,array:on(e.array,i)}}return L(n,o.k)?e.bitmap===s?void 0:{type:ne,bitmap:e.bitmap^s,array:on(e.array,i)}:e}function Ol(e,t){let r=fn(e,t);if(r<0)return e;if(e.array.length!==1)return{type:rt,hash:e.hash,array:on(e.array,r)}}function Js(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let s=0;s<n;s++){let i=r[s];if(i!==void 0){if(i.type===V){t(i.v,i.k);continue}Js(i,t)}}}var pe=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let s=0;s<r.length;s++){let i=r[s];n=n.set(i,t[i])}return n}static fromMap(t){let r=e.new();return t.forEach((n,s)=>{r=r.set(s,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=dr(this.root,0,ae(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},s=this.root===void 0?an:this.root,i=Nt(s,0,ae(t),t,r,n);return i===this.root?this:new e(i,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=dn(this.root,0,ae(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:dr(this.root,0,ae(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){Js(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+sn(ae(r),ae(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!L(t.get(n,!r),r))throw Hs}),!0}catch(r){if(r===Hs)return!1;throw r}}},Hs=Symbol();var P=class extends ${};var H=class extends ${};var Xe=class extends ${};function mn(e,t){return t>=2&&t<=36?Ks(e,t):new h(void 0)}function Wt(){return gt(l([]))}function Z(e,t){return Ve(e,t)}function wn(e,t,r){let s=e,i=_n(s,t,r);return i}function Pt(e,t){return e+t}function Wl(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head;e=r.tail,t=n+s}}}function gn(e){return Wl(e,"")}function Fl(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return i;{let o=n.head;e=n.tail,t=s,r=i+s+o}}}function ee(e,t){if(e instanceof x)return"";{let r=e.head,n=e.tail;return Fl(n,t,r)}}function Ht(e){let r=Qs(e);return Zs(r)}function xr(e,t){if(t==="")return xn(e);{let n=e,s=hn(n,t);return Y(s,B)}}function yn(e){if(e>1114111)return new h(void 0);{let r=e;if(r>=55296&&r<=57343)return new h(void 0);if(e<0)return new h(void 0);{let s=e;return new d(ei(s))}}}function nt(e){let r=ti(e);return r}var Se=class extends ${constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};var de=class extends ${constructor(t){super(),this.function=t}};var si=new de(Ql),kn=new de(Zl);var O=new de(eu);function Xt(e,t){let r=t.function(e),n,s;return n=r[0],s=r[1],s instanceof x?new d(n):new h(s)}function gr(e){return new de(t=>[e,l([])])}function ii(e,t){return new de(r=>{let n=e.function(r),s,i;return s=n[0],i=n[1],[t(s),i]})}function Yl(e,t,r){for(;;){let n=e,s=t,i=r;if(i instanceof x)return s;{let o=i.head,u=i.tail,a=o.function(n),c,f;if(c=a,f=a[1],f instanceof x)return c;e=n,t=s,r=u}}}function Kl(e,t){return new de(r=>{let n=e.function(r),s,i;return s=n,i=n[1],i instanceof x?s:Yl(r,s,t)})}function oi(e,t){return l([new Se(e,qe(t),l([]))])}function li(e,t,r){let n=r(e);return n instanceof d?[n[0],l([])]:[n[0],l([new Se(t,qe(e),l([]))])]}function Ql(e){return L(!0,e)?[!0,l([])]:L(!1,e)?[!1,l([])]:[!1,oi("Bool",e)]}function Zl(e){return li(e,"Int",pi)}function eu(e){return li(e,"String",fi)}function tu(e,t,r,n,s){let i=n(t),o=i[1];if(o instanceof x){let u=i[0],a=s(r),c=a[1];if(c instanceof x){let f=a[0];return[Ye(e[0],u,f),e[1]]}else{let f=c;return st([se(),f],l(["values"]))}}else{let u=o;return st([se(),u],l(["keys"]))}}function En(e,t){return new de(r=>{let n=ci(r);if(n instanceof d){let s=n[0];return br(s,[se(),l([])],(i,o,u)=>i[1]instanceof x?tu(i,o,u,e.function,t.function):i)}else return[se(),oi("Dict",r)]})}function ui(e){return new de(t=>ai(t,e.function,(r,n)=>st(r,l([n])),0,l([])))}function st(e,t){let r=Kl(O,l([ii(kn,xe)])),n=Y(t,i=>{let o=i,u=Xt(o,r);return u instanceof d?u[0]:"<"+qe(o)+">"}),s=Y(e[1],i=>new Se(i.expected,i.found,Ke(n,i.path)));return[e[0],s]}function ru(e,t,r,n,s){for(;;){let i=e,o=t,u=r,a=n,c=s;if(i instanceof x){let m=u(a);return st(m,C(o))}else{let f=i.head,m=i.tail,g=Sn(a,f);if(g instanceof d){let y=g[0];if(y instanceof w){let v=y[0];e=m,t=p(f,o),r=u,n=v,s=c}else return c(a,p(f,o))}else{let y=g[0],v=u(a),S;S=v[0];let R=[S,l([new Se(y,qe(a),l([]))])];return st(R,C(o))}}}}function nu(e,t,r){return new de(n=>{let s=ru(e,l([]),t.function,n,(f,m)=>{let g=t.function(f),y;y=g[0];let v=[y,l([new Se("Field","Nothing",l([]))])];return st(v,C(m))}),i,o;i=s[0],o=s[1];let u=r(i).function(n),a,c;return a=u[0],c=u[1],[a,Ke(o,c)]})}function N(e,t,r){return nu(l([e]),t,r)}function yr(e,t,r,n){return new de(s=>{let i,o,u=Sn(s,e);if(u instanceof d){let S=u[0];if(S instanceof w){let R=S[0];o=r.function(R)}else o=[t,l([])]}else{let S=u[0];o=[t,l([new Se(S,qe(s),l([]))])]}i=st(o,l([e]));let c=i,f,m;f=c[0],m=c[1];let g=n(f).function(s),y,v;return y=g[0],v=g[1],[y,Ke(m,v)]})}var vr=void 0,di={};function B(e){return e}function Je(e){return/^[-+]?(\d+)$/.test(e)?new d(parseInt(e)):new h(vr)}function xe(e){return e.toString()}var iu={2:/[^0-1]/,3:/[^0-2]/,4:/[^0-3]/,5:/[^0-4]/,6:/[^0-5]/,7:/[^0-6]/,8:/[^0-7]/,9:/[^0-8]/,10:/[^0-9]/,11:/[^0-9a]/,12:/[^0-9a-b]/,13:/[^0-9a-c]/,14:/[^0-9a-d]/,15:/[^0-9a-e]/,16:/[^0-9a-f]/,17:/[^0-9a-g]/,18:/[^0-9a-h]/,19:/[^0-9a-i]/,20:/[^0-9a-j]/,21:/[^0-9a-k]/,22:/[^0-9a-l]/,23:/[^0-9a-m]/,24:/[^0-9a-n]/,25:/[^0-9a-o]/,26:/[^0-9a-p]/,27:/[^0-9a-q]/,28:/[^0-9a-r]/,29:/[^0-9a-s]/,30:/[^0-9a-t]/,31:/[^0-9a-u]/,32:/[^0-9a-v]/,33:/[^0-9a-w]/,34:/[^0-9a-x]/,35:/[^0-9a-y]/,36:/[^0-9a-z]/};function Ks(e,t){if(iu[t].test(e.replace(/^-/,"").toLowerCase()))return new h(vr);let r=parseInt(e,t);return isNaN(r)?new h(vr):new d(r)}function _n(e,t,r){return e.replaceAll(t,r)}function xn(e){let t=ou(e);return t?W.fromArray(Array.from(t).map(r=>r.segment)):W.fromArray(e.match(/./gsu))}var $i;function ou(e){if(globalThis.Intl&&Intl.Segmenter)return $i||=new Intl.Segmenter,$i.segment(e)[Symbol.iterator]()}function it(e){return[e.charCodeAt(0)|0,e.slice(1)]}function he(e){return e.toLowerCase()}function Ve(e,t){return e+t}function hn(e,t){return W.fromArray(e.split(t))}function gt(e){let t="";for(let r of e)t=t+r;return t}function G(e,t,r){return e.slice(t,t+r)}function hr(e,t){return e.startsWith(t)}var mi=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),lu=new RegExp(`^[${mi}]*`),uu=new RegExp(`[${mi}]*$`);function Qs(e){return e.replace(lu,"")}function Zs(e){return e.replace(uu,"")}function ei(e){return new Ot(e)}function wr(e){return e.toArray().map(t=>String.fromCodePoint(t.value)).join("")}function se(){return pe.new()}function _i(e){return W.fromArray(e.entries())}function Ce(e,t){let r=e.get(t,di);return r===di?new h(vr):new d(r)}function xi(e,t,r){return r.set(e,t)}function qe(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof _t)return"Result";if(e instanceof W)return"List";if(e instanceof mt)return"BitArray";if(e instanceof pe)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return"Array";if(typeof e=="number")return"Float";if(e===null)return"Nil";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function ti(e){return new Cn().inspect(e)}function _r(e){let t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{let r=t.indexOf("e");return r>=0?t.slice(0,r)+".0"+t.slice(r):t+".0"}}var Cn=class{#e=new Set;inspect(t){let r=typeof t;if(t===!0)return"True";if(t===!1)return"False";if(t===null)return"//js(null)";if(t===void 0)return"Nil";if(r==="string")return this.#i(t);if(r==="bigint"||Number.isInteger(t))return t.toString();if(r==="number")return _r(t);if(t instanceof Ot)return this.#o(t);if(t instanceof mt)return this.#l(t);if(t instanceof RegExp)return`//js(${t})`;if(t instanceof Date)return`//js(Date("${t.toISOString()}"))`;if(t instanceof globalThis.Error)return`//js(${t.toString()})`;if(t instanceof Function){let s=[];for(let i of Array(t.length).keys())s.push(String.fromCharCode(i+97));return`//fn(${s.join(", ")}) { ... }`}if(this.#e.size===this.#e.add(t).size)return"//js(circular reference)";let n;if(Array.isArray(t))n=`#(${t.map(s=>this.inspect(s)).join(", ")})`;else if(t instanceof W)n=this.#s(t);else if(t instanceof $)n=this.#n(t);else if(t instanceof pe)n=this.#r(t);else{if(t instanceof Set)return`//js(Set(${[...t].map(s=>this.inspect(s)).join(", ")}))`;n=this.#t(t)}return this.#e.delete(t),n}#t(t){let r=Object.getPrototypeOf(t)?.constructor?.name||"Object",n=[];for(let o of Object.keys(t))n.push(`${this.inspect(o)}: ${this.inspect(t[o])}`);let s=n.length?" "+n.join(", ")+" ":"";return`//js(${r==="Object"?"":r+" "}{${s}})`}#r(t){let r="dict.from_list([",n=!0;return t.forEach((s,i)=>{n||(r=r+", "),r=r+"#("+this.inspect(i)+", "+this.inspect(s)+")",n=!1}),r+"])"}#n(t){let r=Object.keys(t).map(n=>{let s=this.inspect(t[n]);return isNaN(parseInt(n))?`${n}: ${s}`:s}).join(", ");return r?`${t.constructor.name}(${r})`:t.constructor.name}#s(t){if(t instanceof x)return"[]";let r='charlist.from_string("',n="[",s=t;for(;s instanceof tt;){let i=s.head;s=s.tail,n!=="["&&(n+=", "),n+=this.inspect(i),r&&(Number.isInteger(i)&&i>=32&&i<=126?r+=String.fromCharCode(i):r=null)}return r?r+'")':n+"]"}#i(t){let r='"';for(let n=0;n<t.length;n++){let s=t[n];switch(s){case`
`:r+="\\n";break;case"\r":r+="\\r";break;case"	":r+="\\t";break;case"\f":r+="\\f";break;case"\\":r+="\\\\";break;case'"':r+='\\"';break;default:s<" "||s>"~"&&s<"\xA0"?r+="\\u{"+s.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":r+=s}}return r+='"',r}#o(t){return`//utfcodepoint(${String.fromCodePoint(t.value)})`}#l(t){if(t.bitSize===0)return"<<>>";let r="<<";for(let n=0;n<t.byteSize-1;n++)r+=t.byteAt(n).toString(),r+=", ";if(t.byteSize*8===t.bitSize)r+=t.byteAt(t.byteSize-1).toString();else{let n=t.bitSize%8;r+=t.byteAt(t.byteSize-1)>>8-n,r+=`:size(${n})`}return r+=">>",r}};function Sn(e,t){if(e instanceof pe||e instanceof WeakMap||e instanceof Map){let n={},s=e.get(t,n);return s===n?new d(new z):new d(new w(s))}let r=Number.isInteger(t);if(r&&t>=0&&t<8&&e instanceof W){let n=0;for(let s of e){if(n===t)return new d(new w(s));n++}return new h("Indexable")}return r&&Array.isArray(e)||e&&typeof e=="object"||e&&Object.getPrototypeOf(e)===Object.prototype?t in e?new d(new w(e[t])):new d(new z):new h(r?"Indexable":"Dict")}function ai(e,t,r,n,s){if(!(e instanceof W||Array.isArray(e))){let o=new Se("List",qe(e),s);return[s,W.fromArray([o])]}let i=[];for(let o of e){let u=t(o),[a,c]=u;if(c instanceof tt){let[f,m]=r(u,n.toString());return[s,m]}i.push(a),n++}return[W.fromArray(i),s]}function ci(e){if(e instanceof pe)return new d(e);if(e instanceof Map||e instanceof WeakMap)return new d(pe.fromMap(e));if(e==null)return new h("Dict");if(typeof e!="object")return new h("Dict");let t=Object.getPrototypeOf(e);return t===Object.prototype||t===null?new d(pe.fromObject(e)):new h("Dict")}function pi(e){return Number.isInteger(e)?new d(e):new h(0)}function fi(e){return typeof e=="string"?new d(e):new h("")}function Ye(e,t,r){return xi(t,r,e)}function au(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.tail,i=r.head[0],o=r.head[1];e=s,t=Ye(n,i,o)}}}function wt(e){return au(e,se())}function cu(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return s;{let o=n.tail,u=n.head[0],a=n.head[1];e=o,t=i(s,u,a),r=i}}}function br(e,t,r){return cu(_i(e),t,r)}var X=class extends ${},ot=class extends ${};function yt(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head;e=r.tail,t=p(s,n)}}}function C(e){return yt(e,l([]))}function Tn(e,t){for(;;){let r=e,n=t;if(r instanceof x)return!1;{let s=r.head;if(L(s,n))return!0;e=r.tail,t=n}}}function pu(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return C(i);{let o=n.head,u=n.tail,a;s(o)?a=p(o,i):a=i;let f=a;e=u,t=s,r=f}}}function bt(e,t){return pu(e,t,l([]))}function fu(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return C(i);{let o=n.head,u=n.tail,a,c=s(o);if(c instanceof d){let m=c[0];a=p(m,i)}else a=i;let f=a;e=u,t=s,r=f}}}function Ae(e,t){return fu(e,t,l([]))}function du(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return C(i);{let o=n.head;e=n.tail,t=s,r=p(s(o),i)}}}function Y(e,t){return du(e,t,l([]))}function $u(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head;e=r.tail,t=p(s,n)}}}function Ke(e,t){return $u(C(e),t)}function mu(e,t){for(;;){let r=e,n=t;if(r instanceof x)return C(n);{let s=r.head;e=r.tail,t=yt(s,n)}}}function Mn(e){return mu(e,l([]))}function Ue(e,t){return Mn(Y(e,t))}function vt(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return s;{let o=n.head;e=n.tail,t=i(s,o),r=i}}}function _u(e,t,r,n,s,i){for(;;){let o=e,u=t,a=r,c=n,f=s,m=i,g=p(f,a);if(o instanceof x)return c instanceof X?p(C(g),m):p(g,m);{let y=o.head,v=o.tail,S=u(f,y);if(c instanceof X)if(S instanceof P)e=v,t=u,r=g,n=c,s=y,i=m;else if(S instanceof H)e=v,t=u,r=g,n=c,s=y,i=m;else{let R;c instanceof X?R=p(C(g),m):R=p(g,m);let j=R;if(v instanceof x)return p(l([y]),j);{let I=v.head,U=v.tail,q,A=u(y,I);A instanceof P?q=new X:A instanceof H?q=new X:q=new ot;let _e=q;e=U,t=u,r=l([y]),n=_e,s=I,i=j}}else if(S instanceof P){let R;c instanceof X?R=p(C(g),m):R=p(g,m);let j=R;if(v instanceof x)return p(l([y]),j);{let I=v.head,U=v.tail,q,A=u(y,I);A instanceof P?q=new X:A instanceof H?q=new X:q=new ot;let _e=q;e=U,t=u,r=l([y]),n=_e,s=I,i=j}}else if(S instanceof H){let R;c instanceof X?R=p(C(g),m):R=p(g,m);let j=R;if(v instanceof x)return p(l([y]),j);{let I=v.head,U=v.tail,q,A=u(y,I);A instanceof P?q=new X:A instanceof H?q=new X:q=new ot;let _e=q;e=U,t=u,r=l([y]),n=_e,s=I,i=j}}else e=v,t=u,r=g,n=c,s=y,i=m}}}function xu(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(s instanceof x)return yt(i,u);if(i instanceof x)return yt(s,u);{let a=s.head,c=s.tail,f=i.head,m=i.tail,g=o(a,f);g instanceof P?(e=c,t=i,r=o,n=p(a,u)):g instanceof H?(e=s,t=m,r=o,n=p(f,u)):(e=s,t=m,r=o,n=p(f,u))}}}function hu(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return C(i);{let o=n.tail;if(o instanceof x){let u=n.head;return C(p(C(u),i))}else{let u=n.head,a=o.head,c=o.tail,f=xu(u,a,s,l([]));e=c,t=s,r=p(f,i)}}}}function wu(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(s instanceof x)return yt(i,u);if(i instanceof x)return yt(s,u);{let a=s.head,c=s.tail,f=i.head,m=i.tail,g=o(a,f);g instanceof P?(e=s,t=m,r=o,n=p(f,u)):g instanceof H?(e=c,t=i,r=o,n=p(a,u)):(e=c,t=i,r=o,n=p(a,u))}}}function gu(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return C(i);{let o=n.tail;if(o instanceof x){let u=n.head;return C(p(C(u),i))}else{let u=n.head,a=o.head,c=o.tail,f=wu(u,a,s,l([]));e=c,t=s,r=p(f,i)}}}}function yu(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return n;if(s instanceof X){if(n.tail instanceof x)return n.head;e=hu(n,i,l([])),t=new ot,r=i}else if(n.tail instanceof x){let u=n.head;return C(u)}else e=gu(n,i,l([])),t=new X,r=i}}function wi(e,t){if(e instanceof x)return e;{let r=e.tail;if(r instanceof x)return e;{let n=e.head,s=r.head,i=r.tail,o,u=t(n,s);u instanceof P?o=new X:u instanceof H?o=new X:o=new ot;let a=o,c=_u(i,t,l([n]),a,s,l([]));return yu(c,new X,t)}}}function Gt(e,t){if(e instanceof d){let r=e[0];return new d(t(r))}else return e}function jn(e,t){if(e instanceof d)return e;{let r=e[0];return new h(t(r))}}function b(e,t){if(e instanceof d){let r=e[0];return t(r)}else return e}function Jt(e,t){return e instanceof d?e[0]:t}function Qe(e,t){return e instanceof d?e:new h(t)}var E=class extends ${constructor(t,r,n,s,i,o,u){super(),this.scheme=t,this.userinfo=r,this.host=n,this.port=s,this.path=i,this.query=o,this.fragment=u}};var ku=new E(new z,new z,new z,new z,"",new z,new z);function Eu(e){return 48>=e&&e<=57||65>=e&&e<=90||97>=e&&e<=122||e===58||e===46}function we(e,t){return new d(new E(t.scheme,t.userinfo,t.host,t.port,t.path,t.query,new w(e)))}function Ru(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(i.startsWith("#"))if(u===0){let a=i.slice(1);return we(a,o)}else{let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,o.host,o.port,o.path,new w(c),o.fragment);return we(a,f)}else{if(i==="")return new d(new E(o.scheme,o.userinfo,o.host,o.port,o.path,new w(s),o.fragment));{let a=it(i),c;c=a[1],e=s,t=c,r=o,n=u+1}}}}function Ne(e,t){return Ru(e,e,t,0)}function Su(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(i.startsWith("?")){let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,o.host,o.port,c,o.query,o.fragment);return Ne(a,f)}else if(i.startsWith("#")){let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,o.host,o.port,c,o.query,o.fragment);return we(a,f)}else{if(i==="")return new d(new E(o.scheme,o.userinfo,o.host,o.port,s,o.query,o.fragment));{let a=it(i),c;c=a[1],e=s,t=c,r=o,n=u+1}}}}function lt(e,t){return Su(e,e,t,0)}function ze(e,t,r){for(;;){let n=e,s=t,i=r;if(n.startsWith("0"))e=n.slice(1),t=s,r=i*10;else if(n.startsWith("1"))e=n.slice(1),t=s,r=i*10+1;else if(n.startsWith("2"))e=n.slice(1),t=s,r=i*10+2;else if(n.startsWith("3"))e=n.slice(1),t=s,r=i*10+3;else if(n.startsWith("4"))e=n.slice(1),t=s,r=i*10+4;else if(n.startsWith("5"))e=n.slice(1),t=s,r=i*10+5;else if(n.startsWith("6"))e=n.slice(1),t=s,r=i*10+6;else if(n.startsWith("7"))e=n.slice(1),t=s,r=i*10+7;else if(n.startsWith("8"))e=n.slice(1),t=s,r=i*10+8;else if(n.startsWith("9"))e=n.slice(1),t=s,r=i*10+9;else if(n.startsWith("?")){let o=n.slice(1),u=new E(s.scheme,s.userinfo,s.host,new w(i),s.path,s.query,s.fragment);return Ne(o,u)}else if(n.startsWith("#")){let o=n.slice(1),u=new E(s.scheme,s.userinfo,s.host,new w(i),s.path,s.query,s.fragment);return we(o,u)}else if(n.startsWith("/")){let o=new E(s.scheme,s.userinfo,s.host,new w(i),s.path,s.query,s.fragment);return lt(n,o)}else return n===""?new d(new E(s.scheme,s.userinfo,s.host,new w(i),s.path,s.query,s.fragment)):new h(void 0)}}function kr(e,t){if(e.startsWith(":0")){let r=e.slice(2);return ze(r,t,0)}else if(e.startsWith(":1")){let r=e.slice(2);return ze(r,t,1)}else if(e.startsWith(":2")){let r=e.slice(2);return ze(r,t,2)}else if(e.startsWith(":3")){let r=e.slice(2);return ze(r,t,3)}else if(e.startsWith(":4")){let r=e.slice(2);return ze(r,t,4)}else if(e.startsWith(":5")){let r=e.slice(2);return ze(r,t,5)}else if(e.startsWith(":6")){let r=e.slice(2);return ze(r,t,6)}else if(e.startsWith(":7")){let r=e.slice(2);return ze(r,t,7)}else if(e.startsWith(":8")){let r=e.slice(2);return ze(r,t,8)}else if(e.startsWith(":9")){let r=e.slice(2);return ze(r,t,9)}else{if(e===":")return new d(t);if(e==="")return new d(t);if(e.startsWith("?")){let r=e.slice(1);return Ne(r,t)}else if(e.startsWith(":?")){let r=e.slice(2);return Ne(r,t)}else if(e.startsWith("#")){let r=e.slice(1);return we(r,t)}else if(e.startsWith(":#")){let r=e.slice(2);return we(r,t)}else{if(e.startsWith("/"))return lt(e,t);if(e.startsWith(":")){let r=e.slice(1);return r.startsWith("/")?lt(r,t):new h(void 0)}else return new h(void 0)}}}function gi(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(i==="")return new d(new E(o.scheme,o.userinfo,new w(s),o.port,o.path,o.query,o.fragment));if(i.startsWith(":")){let a=G(s,0,u),c=new E(o.scheme,o.userinfo,new w(a),o.port,o.path,o.query,o.fragment);return kr(i,c)}else if(i.startsWith("/")){let a=G(s,0,u),c=new E(o.scheme,o.userinfo,new w(a),o.port,o.path,o.query,o.fragment);return lt(i,c)}else if(i.startsWith("?")){let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,new w(c),o.port,o.path,o.query,o.fragment);return Ne(a,f)}else if(i.startsWith("#")){let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,new w(c),o.port,o.path,o.query,o.fragment);return we(a,f)}else{let a=it(i),c;c=a[1],e=s,t=c,r=o,n=u+1}}}function Cu(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(i==="")return new d(new E(o.scheme,o.userinfo,new w(i),o.port,o.path,o.query,o.fragment));if(i.startsWith("]"))if(u===0){let a=i.slice(1);return kr(a,o)}else{let a=i.slice(1),c=G(s,0,u+1),f=new E(o.scheme,o.userinfo,new w(c),o.port,o.path,o.query,o.fragment);return kr(a,f)}else if(i.startsWith("/")){if(u===0)return lt(i,o);{let a=G(s,0,u),c=new E(o.scheme,o.userinfo,new w(a),o.port,o.path,o.query,o.fragment);return lt(i,c)}}else if(i.startsWith("?"))if(u===0){let a=i.slice(1);return Ne(a,o)}else{let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,new w(c),o.port,o.path,o.query,o.fragment);return Ne(a,f)}else if(i.startsWith("#"))if(u===0){let a=i.slice(1);return we(a,o)}else{let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,o.userinfo,new w(c),o.port,o.path,o.query,o.fragment);return we(a,f)}else{let a=it(i),c,f;if(c=a[0],f=a[1],Eu(c))e=s,t=f,r=o,n=u+1;else return gi(s,s,o,0)}}}function Au(e,t){return Cu(e,e,t,0)}function zu(e,t){return gi(e,e,t,0)}function kt(e,t){if(e.startsWith("["))return Au(e,t);if(e.startsWith(":")){let r=new E(t.scheme,t.userinfo,new w(""),t.port,t.path,t.query,t.fragment);return kr(e,r)}else return e===""?new d(new E(t.scheme,t.userinfo,new w(""),t.port,t.path,t.query,t.fragment)):zu(e,t)}function Tu(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(i.startsWith("@"))if(u===0){let a=i.slice(1);return kt(a,o)}else{let a=i.slice(1),c=G(s,0,u),f=new E(o.scheme,new w(c),o.host,o.port,o.path,o.query,o.fragment);return kt(a,f)}else{if(i==="")return kt(s,o);if(i.startsWith("/"))return kt(s,o);if(i.startsWith("?"))return kt(s,o);if(i.startsWith("#"))return kt(s,o);{let a=it(i),c;c=a[1],e=s,t=c,r=o,n=u+1}}}}function Mu(e,t){return Tu(e,e,t,0)}function In(e,t){if(e==="//")return new d(new E(t.scheme,t.userinfo,new w(""),t.port,t.path,t.query,t.fragment));if(e.startsWith("//")){let r=e.slice(2);return Mu(r,t)}else return lt(e,t)}function ju(e,t,r,n){for(;;){let s=e,i=t,o=r,u=n;if(i.startsWith("/")){if(u===0)return In(i,o);{let a=G(s,0,u),c=new E(new w(he(a)),o.userinfo,o.host,o.port,o.path,o.query,o.fragment);return In(i,c)}}else if(i.startsWith("?"))if(u===0){let a=i.slice(1);return Ne(a,o)}else{let a=i.slice(1),c=G(s,0,u),f=new E(new w(he(c)),o.userinfo,o.host,o.port,o.path,o.query,o.fragment);return Ne(a,f)}else if(i.startsWith("#"))if(u===0){let a=i.slice(1);return we(a,o)}else{let a=i.slice(1),c=G(s,0,u),f=new E(new w(he(c)),o.userinfo,o.host,o.port,o.path,o.query,o.fragment);return we(a,f)}else if(i.startsWith(":")){if(u===0)return new h(void 0);{let a=i.slice(1),c=G(s,0,u),f=new E(new w(he(c)),o.userinfo,o.host,o.port,o.path,o.query,o.fragment);return In(a,f)}}else{if(i==="")return new d(new E(o.scheme,o.userinfo,o.host,o.port,s,o.query,o.fragment));{let a=it(i),c;c=a[1],e=s,t=c,r=o,n=u+1}}}}function yi(e){let t,r=e.fragment;if(r instanceof w){let A=r[0];t=l(["#",A])}else t=l([]);let n=t,s,i=e.query;if(i instanceof w){let A=i[0];s=p("?",p(A,n))}else s=n;let o=s,u=p(e.path,o),a,c=e.host,f=hr(e.path,"/");c instanceof w&&!f&&c[0]!==""?a=p("/",u):a=u;let m=a,g,y=e.host,v=e.port;if(y instanceof w&&v instanceof w){let A=v[0];g=p(":",p(xe(A),m))}else g=m;let S=g,R,j=e.scheme,I=e.userinfo,U=e.host;if(j instanceof w)if(I instanceof w)if(U instanceof w){let A=j[0],_e=I[0],Qr=U[0];R=p(A,p("://",p(_e,p("@",p(Qr,S)))))}else{let A=j[0];R=p(A,p(":",S))}else if(U instanceof w){let A=j[0],_e=U[0];R=p(A,p("://",p(_e,S)))}else{let A=j[0];R=p(A,p(":",S))}else if(I instanceof z&&U instanceof w){let A=U[0];R=p("//",p(A,S))}else R=S;return gn(R)}function bi(e){return ju(e,e,ku,0)}var Vt=class extends ${};var Bn=class extends ${};var Dn=class extends ${};var On=class extends ${};var qn=class extends ${};var Ln=class extends ${};var Un=class extends ${};var Nn=class extends ${};var Wn=class extends ${};var Er=class extends ${};var Yt=class extends ${};function ki(e){return e instanceof Vt?"GET":e instanceof Bn?"POST":e instanceof Dn?"HEAD":e instanceof On?"PUT":e instanceof qn?"DELETE":e instanceof Ln?"TRACE":e instanceof Un?"CONNECT":e instanceof Nn?"OPTIONS":e instanceof Wn?"PATCH":e[0]}function Ei(e){return e instanceof Er?"http":"https"}function Ri(e){let t=he(e);return t==="http"?new d(new Er):t==="https"?new d(new Yt):new h(void 0)}var Fn=class extends ${constructor(t,r,n,s,i,o,u,a){super(),this.method=t,this.headers=r,this.body=n,this.scheme=s,this.host=i,this.port=o,this.path=u,this.query=a}};function Ai(e){return new E(new w(Ei(e.scheme)),new z,new w(e.host),e.port,e.path,e.query,new z)}function Lu(e){return b((()=>{let t=e.scheme,r=xt(t,"");return Ri(r)})(),t=>b((()=>{let r=e.host;return en(r,void 0)})(),r=>{let n=new Fn(new Vt,l([]),"",t,r,e.port,e.path,e.query);return new d(n)}))}function zi(e){let r=bi(e);return b(r,Lu)}var Rr=class extends ${constructor(t,r,n){super(),this.status=t,this.headers=r,this.body=n}};var Et=class e{constructor(t){this.promise=t}static wrap(t){return t instanceof Promise?new e(t):t}static unwrap(t){return t instanceof e?t.promise:t}};function ie(e){return Promise.resolve(Et.wrap(e))}function Sr(e,t){return e.then(r=>t(Et.unwrap(r)))}function Rt(e,t){return e.then(r=>Et.wrap(t(Et.unwrap(r))))}function Pn(e){return new Promise(t=>{globalThis.setTimeout(t,e)})}function Cr(...e){return e.length===1?Promise.race(e[0]):Promise.race(e)}function Ti(e,t){return Rt(e,n=>(t(n),n))}function Mi(e,t){return Sr(e,n=>{if(n instanceof d){let s=n[0];return t(s)}else{let s=n[0];return ie(new h(s))}})}async function ji(e){try{return new d(await fetch(e))}catch(t){return new h(new Ar(t.toString()))}}function Ii(e){return new Rr(e.status,W.fromArray([...e.headers]),e)}function Fu(e){let t=yi(Ai(e)),r=ki(e.method).toUpperCase(),n={headers:Pu(e.headers),method:r};return[t,n]}function Bi(e){let[t,r]=Fu(e);return r.method!=="GET"&&r.method!=="HEAD"&&(r.body=e.body),new globalThis.Request(t,r)}function Pu(e){let t=new globalThis.Headers;for(let[r,n]of e)t.append(r.toLowerCase(),n);return t}async function Xn(e){let t;try{t=await e.body.text()}catch{return new h(new zr)}return new d(e.withFields({body:t}))}var Ar=class extends ${constructor(t){super(),this[0]=t}};var zr=class extends ${};function Di(e){let r=Bi(e),n=ji(r);return Mi(n,s=>ie(new d(Ii(s))))}function Oi(e,t){try{let r="gu";return t.case_insensitive&&(r+="i"),t.multi_line&&(r+="m"),new d(new RegExp(e,r))}catch(r){let n=(r.columnNumber||0)|0;return new h(new Tr(r.message,n))}}function Gn(e,t,r){return e.lastIndex=0,t.replaceAll(e,r)}var Tr=class extends ${constructor(t,r){super(),this.error=t,this.byte_index=r}};var Jn=class extends ${constructor(t,r){super(),this.case_insensitive=t,this.multi_line=r}};function Xu(e,t){return Oi(e,t)}function qi(e){return Xu(e,new Jn(!1,!1))}function Li(e){let t="",r=e;for(;r.tail;)t!==""&&(t+="|"),t+=Ju(r.head),r=r.tail;return new RegExp(t)}function Vn(e,t){let r=t.match(e);if(!r)return[t,"",""];let n=r.index,s=r[0];return[t.slice(0,n),s,t.slice(n+s.length)]}function Ju(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Te(e){let r=bt(e,n=>n!=="");return Li(r)}var te=class extends ${constructor(t){super(),this[0]=t}},Kt=class extends ${constructor(t,r,n,s){super(),this.last_delimiter=t,this.input=r,this.splitters=n,this.mode=s}},Me=class extends ${constructor(t,r,n){super(),this.data=t,this.delimiter=r,this.remaining=n}},Mr=class extends ${constructor(t,r,n){super(),this.parser=t,this.initial_mode=r,this.splitters=n}};function Ni(e,t){return new Mr(e,t,se())}function je(e,t,r){return new Mr(e.parser,e.initial_mode,Ye(e.splitters,t,r))}function Wi(e,t){let r=new Kt("",t,e.splitters,e.initial_mode),n=e.parser,s;return s=n[0],b(s(r),i=>i.remaining===""?new d(i.data):new h("Parser did not consume all input. Remaining input: '"+i.remaining+"'"))}function T(e){return new te(t=>new d(new Me(e,t.last_delimiter,t.input)))}function ge(e){return new te(t=>new h(e))}function We(){return new te(e=>{let t=(()=>{let r=e.splitters;return Ce(r,e.mode)})();if(t instanceof d){let r=t[0],n=Vn(r,e.input),s,i,o;return s=n[0],i=n[1],o=n[2],new d(new Me(s,i,o))}else return new h("Current mode isn't registered !")})}function Qt(e,t){return new Kt(t.delimiter,t.remaining,e.splitters,e.mode)}function k(e,t){return new te(r=>{let n;return n=e[0],b(n(r),s=>{let i=Qt(r,s),o=t(s.data),u;return u=o[0],u(i)})})}function ut(e,t){return new te(r=>{let n;return n=e[0],b(n(r),s=>{let i=Qt(r,s),o=t(s.data,s.delimiter),u;return u=o[0],u(i)})})}function Fi(e,t,r,n){let s;return s=t[0],b(s(e),i=>r(i.delimiter)?Fi(Qt(e,i),t,r,p(i.data,n)):new d(new Me((()=>{let u=p(i.data,n);return C(u)})(),i.delimiter,i.remaining)))}function Pi(e,t){return new te(r=>Fi(r,e,t,l([])))}function Hi(e,t,r,n){let s;return s=t[0],b(s(e),i=>r(i.delimiter)?Hi(Qt(e,i),t,r,p(i.data,n)):new d(new Me((()=>{let u=p(i.data,n);return C(u)})(),i.delimiter,i.remaining)))}function Yn(e,t){return new te(r=>t(r.last_delimiter)?Hi(r,e,t,l([])):new d(new Me(l([]),r.last_delimiter,r.input)))}function Ie(e){return new te(t=>{let r=We(),n;return n=r[0],b(n(t),s=>s.delimiter===e?new d(s):new h("Expected '"+e+"' but got '"+s.delimiter+"'"))})}function Kn(e){return new te(t=>{let r=We(),n;return n=r[0],b(n(t),s=>Tn(e,s.delimiter)?new d(s):new h("Expected one of '"+ee(e,"', '")+"' but got '"+s.delimiter+"'"))})}function jr(e){return new te(t=>{let r;r=e[0];let n=r(t);if(n instanceof d){let s=n[0];return new d(new Me(new w(s.data),s.delimiter,s.remaining))}else return new d(new Me(new z,"",t.input))})}function Xi(e,t){let r=We(),n;return n=r[0],b(n(e),s=>t(s.data,s.delimiter)?Xi(Qt(e,s),t):new d(new Me(void 0,"",e.input)))}function Vu(e){return new te(t=>Xi(t,e))}function oe(e){return Vu((t,r)=>t===""&&Tn(e,r))}function Be(e,t){return new te(r=>{let n=new Kt(r.last_delimiter,r.input,r.splitters,e),s=t(),i;return i=s[0],i(n)})}var Ku="src/gleaxml.gleam",Br=class extends ${};var Dr=class extends ${};var Or=class extends ${};var er=class extends ${};var qr=class extends ${};var Lr=class extends ${};var Ur=class extends ${};var Nr=class extends ${};var Wr=class extends ${};var Ct=class extends ${};var At=class extends ${};var Fr=class extends ${};var Pr=class extends ${constructor(t,r,n,s){super(),this.version=t,this.encoding=r,this.standalone=n,this.root_element=s}};var De=class extends ${constructor(t,r,n){super(),this.name=t,this.attrs=r,this.children=n}};var ye=class extends ${constructor(t){super(),this.content=t}};var Qn=class extends ${constructor(t){super(),this.content=t}};var Qu="<![CDATA[",Ji="]]>",Zu="<!--",Vi="-->",Yi="<?xml",Zt="?>",Ki="&#x",Qi="&#",Zi="&",eo=";";function ea(){return Te(l(["/>",">","=",'"',"'","\r",`
`," "]))}function ta(){return Te(l([">","\r"," ",`
`]))}function Gi(e){return e==="yes"?T(!0):e==="no"?T(!1):ge("Expected 'yes' or 'no' for 'standalone' attribute")}function ra(e,t){return e instanceof Ct?"&#"+t+";":e instanceof At?"&#x"+t+";":"&"+t+";"}function na(e){let t=qi(`
\\s*`),r;if(t instanceof d)r=t[0];else throw fr("let_assert",Ku,"gleaxml",389,"fix_text_whitespace","Pattern match failed, no pattern matched the value.",{value:t,start:11018,end:11067,pattern_start:11029,pattern_end:11036});return Gn(r,e," ")}function sa(e,t){for(;;){let r=e,n=t;if(r instanceof x)return C(n);if(n instanceof x){let s=r.head;e=r.tail,t=p(s,n)}else{let s=r.head;if(s instanceof ye){let i=n.head;if(i instanceof ye){let o=r.tail,u=n.tail,a=s.content,c=i.content,f=new ye(c+a);e=o,t=p(f,u)}else{let o=s;e=r.tail,t=p(o,n)}}else{let i=s;e=r.tail,t=p(i,n)}}}}function ia(e){if(e instanceof x)return e;{let t=e.tail;if(t instanceof x)return e;{let r=e.head;return sa(t,l([r]))}}}function oa(e){return Be(new Or,()=>k(oe(l([" ","\r",`
`])),t=>k(Ie(">"),r=>r===e?T(void 0):ge("Expected closing tag '</"+e+">' but got '</"+r+">'"))))}function la(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head;if(s==="*"){let i=r.tail,o;o=Ue(n,c=>c instanceof De?c.children:l([]));let a=o;e=i,t=a}else{let i=s,o=r.tail,u;u=Ue(n,f=>{if(f instanceof De){let g=f.children;return Ae(g,y=>y instanceof De?y.name===i?new d(y):new h(void 0):new h(void 0))}else return l([])});let c=u;e=o,t=c}}}}function zt(e,t){if(t instanceof x)return l([]);if(e instanceof De){let r=t.head;if(e.name===r){let s=t.tail;return la(s,l([e]))}else return l([])}else return l([])}function be(e,t){let r=zt(e,t);if(r instanceof x)return new h("No node found at path "+ee(t,"/"));{let n=r.head;return new d(n)}}function le(e,t){if(e instanceof De){let n=e.attrs,s=Ce(n,t);return Qe(s,"No attribute with name "+t)}else return new h("Node is not an element")}function ua(e){if(e instanceof De){let r=e.children;return Ae(r,n=>{if(n instanceof ye){let s=n.content;return new d(s)}else return new h(void 0)})}else return l([])}function Tt(e){let t=ua(e);return bt(t,r=>Ht(r)!=="")}function aa(){return Te(l([Ji]))}function ca(){return Be(new Ur,()=>k(Ie(Ji),e=>T(new ye(e))))}function pa(){return Te(l([Vi,"--"]))}function fa(){return Be(new qr,()=>k(Ie(Vi),e=>T(new Qn(e))))}function da(){return Te(l([Yi,"<","\r",`
`," "]))}function $a(){return Te(l(["=",'"',"'",Zt,"\r",`
`," "]))}function ma(){return Te(l([Ki,Qi,Zi,'"',"'"]))}function _a(){return Te(l(["</",Ki,Qi,Zi,Zu,Qu,"<"]))}function xa(){return Te(l([eo]))}function St(e){return Be(new Nr,()=>k(Ie(eo),t=>{let r;e instanceof Ct?r=b(mn(t,10),s=>b(yn(s),i=>new d(wr(l([i]))))):e instanceof At?r=b(mn(t,16),s=>b(yn(s),i=>new d(wr(l([i]))))):t==="lt"?r=new d("<"):t==="gt"?r=new d(">"):t==="amp"?r=new d("&"):t==="apos"?r=new d("'"):t==="quot"?r=new d('"'):r=new h(void 0);let n=r;if(n instanceof d){let s=n[0];return T(s)}else return ge("Invalid reference "+ra(e,t))}))}function ha(e){return Be(new Lr,()=>k(Pi(ut(We(),(t,r)=>k(r===e?T(""):r==="&#x"?St(new At):r==="&#"?St(new Ct):r==="&"?St(new Fr):T(r),n=>T(t+n))),t=>t!==e),t=>T(ee(t,""))))}function Ir(){return k(oe(l([" ","\r",`
`])),e=>k(Ie("="),t=>ut(Kn(l(['"',"'"])),(r,n)=>k(ha(n),s=>T([t,s])))))}function wa(){return Be(new Wr,()=>k(oe(l([" ","\r",`
`])),e=>k(Ir(),t=>{let r,n;if(r=t[0],n=t[1],r==="version"){let i=n;return k(jr(Ir()),o=>{if(o instanceof w){let u=o[0][0];if(u==="encoding"){let a=o[0][1];return k(jr(Ir()),c=>{if(c instanceof w){let f=c[0][0];if(f==="standalone"){let m=c[0][1];return k(Gi(m),g=>k(oe(l([" ","\r",`
`])),y=>k(Ie(Zt),v=>T([i,a,g]))))}else return ge("Unexpected attribute '"+f+"' in XML declaration")}else return k(oe(l([" ","\r",`
`])),f=>k(Ie(Zt),m=>T([i,a,!0])))})}else if(u==="standalone"){let a=o[0][1];return k(Gi(a),c=>k(oe(l([" ","\r",`
`])),f=>k(Ie(Zt),m=>T([i,"UTF-8",c]))))}else return ge("Unexpected attribute '"+u+"' in XML declaration")}else return k(oe(l([" ","\r",`
`])),u=>k(Ie(Zt),a=>T([i,"UTF-8",!0])))})}else return ge("Expected 'version' attribute in XML declaration")})))}function ga(){return k(Yn(k(jr(Ir()),e=>k(Kn(l([" ","\r",`
`,"/>",">"])),t=>T(e))),e=>e!=="/>"&&e!==">"),e=>T((()=>{let r=Oe(e);return wt(r)})()))}function ya(){return Be(new er,()=>ut(We(),(e,t)=>{let r;e===""?r=new z:r=new w(new ye(na(e)));let n=r;return t==="</"?T((()=>{let s=l([n]);return Oe(s)})()):t==="<"?k(Zn(),s=>T((()=>{let i=l([n,new w(s)]);return Oe(i)})())):t==="<!--"?k(fa(),i=>T((()=>{let o=l([n,new w(i)]);return Oe(o)})())):t==="<![CDATA["?k(ca(),o=>T((()=>{let u=l([n,new w(o)]);return Oe(u)})())):t==="&#x"?k(St(new At),u=>{let a=new ye(u);return T((()=>{let c=l([n,new w(a)]);return Oe(c)})())}):t==="&#"?k(St(new Ct),a=>{let c=new ye(a);return T((()=>{let f=l([n,new w(c)]);return Oe(f)})())}):t==="&"?k(St(new Fr),c=>{let f=new ye(c);return T((()=>{let m=l([n,new w(f)]);return Oe(m)})())}):ge("Unexpected delimiter in content")}))}function Zn(){return Be(new Dr,()=>k(oe(l([" ","\r",`
`])),e=>k(We(),t=>ut(ga(),(r,n)=>n==="/>"?T(new De(t,r,l([]))):n===">"?k(ba(),s=>k(oa(t),i=>T(new De(t,r,s)))):ge("Expected '>' or '/>' after attributes")))))}function ba(){return Be(new er,()=>k(Yn(ya(),e=>e!=="</"),e=>{let t=Mn(e),r=ia(t);return T(r)}))}function va(){return k(oe(l([" ","\r",`
`])),e=>ut(We(),(t,r)=>r==="<?xml"?k(wa(),s=>{let i,o,u;return i=s[0],o=s[1],u=s[2],k(oe(l([" ","\r",`
`])),a=>ut(We(),(c,f)=>f==="<"?k(Zn(),m=>k(oe(l([" ","\r",`
`])),g=>T(new Pr(i,o,u,m)))):ge("Expected '<' at start of root element after XML declaration")))}):r==="<"?k(Zn(),s=>k(oe(l([" ","\r",`
`])),i=>T(new Pr("1.0","UTF-8",!0,s)))):ge("Expected '<' or "+Yi+" at start of XML document")))}function to(e){let t=Ni(va(),new Br),r=je(t,new Br,da()),n=je(r,new Dr,ea()),s=je(n,new Or,ta()),i=je(s,new Lr,ma()),o=je(i,new er,_a()),u=je(o,new qr,pa()),a=je(u,new Ur,aa()),c=je(a,new Wr,$a()),f=je(c,new Nr,xa());return Wi(f,e)}var es=class extends ${constructor(t,r){super(),this.version=t,this.channel=r}};var ts=class extends ${constructor(t,r,n,s,i,o,u,a,c,f,m,g,y,v,S,R,j,I,U,q){super(),this.title=t,this.link=r,this.description=n,this.language=s,this.copyright=i,this.managing_editor=o,this.web_master=u,this.pub_date=a,this.last_build_date=c,this.category=f,this.generator=m,this.docs=g,this.cloud=y,this.ttl=v,this.image=S,this.rating=R,this.text_input=j,this.skip_hours=I,this.skip_days=U,this.items=q}};var rs=class extends ${constructor(t,r,n,s,i){super(),this.domain=t,this.port=r,this.path=n,this.register_procedure=s,this.protocol=i}};var ns=class extends ${constructor(t,r,n,s,i,o){super(),this.url=t,this.title=r,this.link=n,this.width=s,this.height=i,this.description=o}};var ss=class extends ${constructor(t,r,n,s){super(),this.title=t,this.description=r,this.name=n,this.link=s}};var is=class extends ${constructor(t,r,n,s,i,o,u,a,c,f){super(),this.title=t,this.link=r,this.description=n,this.author=s,this.category=i,this.comments=o,this.enclosure=u,this.guid=a,this.pub_date=c,this.source=f}};var os=class extends ${constructor(t,r){super(),this.url=t,this.value=r}};var ls=class extends ${constructor(t,r,n){super(),this.url=t,this.length=r,this.type_=n}};var us=class extends ${constructor(t,r){super(),this.domain=t,this.value=r}};var as=class extends ${constructor(t,r){super(),this.is_perma_link=t,this.value=r}};function Ea(e){return b(le(e,"domain"),t=>b(le(e,"port"),r=>b(le(e,"path"),n=>b(le(e,"registerProcedure"),s=>b(le(e,"protocol"),i=>b((()=>{let o=Je(r);return Qe(o,"Invalid port number")})(),o=>new d(new rs(t,o,n,s,i))))))))}function Ra(e){let t=Tt(e),r=ee(t,""),n=Je(r);return Qe(n,"Invalid TTL value")}function Sa(e){return b(le(e,"url"),t=>b(le(e,"length"),r=>b(le(e,"type"),n=>b((()=>{let s=Je(r);return Qe(s,"Invalid length value")})(),s=>new d(new ls(t,s,n))))))}function K(e,t){let r=be(e,t),n=Gt(r,Tt);return Gt(n,s=>ee(s," "))}function Ca(e){return b(K(e,l(["textInput","title"])),t=>b(K(e,l(["textInput","description"])),r=>b(K(e,l(["textInput","name"])),n=>b(K(e,l(["textInput","link"])),s=>new d(new ss(t,r,n,s))))))}function Aa(e){return b(le(e,"url"),t=>b(K(e,l(["source"])),r=>new d(new os(t,r))))}function za(e){let t,r=le(e,"domain");t=re(r);let n=t;return b(K(e,l(["category"])),s=>new d(new us(n,s)))}function Ta(e){let t,r=le(e,"isPermaLink"),n=Gt(r,i=>i==="true");t=re(n);let s=t;return b(K(e,l(["guid"])),i=>new d(new as(s,i)))}function J(e,t){let r=be(e,t),n=re(r),s=ht(n,Tt);return ht(s,i=>ee(i," "))}function Ma(e){return b(K(e,l(["image","url"])),t=>b(K(e,l(["image","title"])),r=>b(K(e,l(["image","link"])),n=>{let s,i=K(e,l(["image","width"])),o=Qe(i,void 0),u=b(o,Je);s=re(u);let a=s,c,f=K(e,l(["image","height"])),m=Qe(f,void 0),g=b(m,Je);c=re(g);let y=c,v=J(e,l(["image","description"]));return new d(new ns(t,r,n,a,y,v))})))}function ja(e){let t=J(e,l(["item","title"])),r=J(e,l(["item","link"])),n=J(e,l(["item","description"])),s=J(e,l(["item","author"])),i,o=zt(e,l(["item","category"]));i=Ae(o,za);let u=i,a=J(e,l(["item","comments"])),c,f=be(e,l(["item","enclosure"])),m=b(f,Sa);c=re(m);let g=c,y,v=be(e,l(["item","guid"])),S=b(v,Ta);y=re(S);let R=y,j=J(e,l(["item","pubDate"])),I,U=be(e,l(["item","source"])),q=b(U,Aa);I=re(q);let A=I;return t instanceof z&&n instanceof z?new h("Item must have at least a title or description"):new d(new is(t,r,n,s,u,a,g,R,j,A))}function Ia(e){return b(K(e,l(["channel","title"])),t=>b(K(e,l(["channel","link"])),r=>b(K(e,l(["channel","description"])),n=>{let s=J(e,l(["channel","language"])),i=J(e,l(["channel","copyright"])),o=J(e,l(["channel","managingEditor"])),u=J(e,l(["channel","webMaster"])),a=J(e,l(["channel","pubDate"])),c=J(e,l(["channel","lastBuildDate"])),f=J(e,l(["channel","category"])),m=J(e,l(["channel","generator"])),g=J(e,l(["channel","docs"])),y,v=be(e,l(["channel","cloud"])),S=b(v,Ea);y=re(S);let R=y,j,I=be(e,l(["channel","ttl"])),U=b(I,Ra);j=re(U);let q=j,A,_e=be(e,l(["channel","image"])),Qr=b(_e,Ma);A=re(Qr);let el=A,tl=J(e,l(["channel","rating"])),Os,rl=be(e,l(["channel","textInput"])),nl=b(rl,Ca);Os=re(nl);let sl=Os,qs,il=zt(e,l(["channel","skipHours","hour"])),ol=Ue(il,Tt);qs=Ae(ol,Je);let ll=qs,Ls,ul=zt(e,l(["channel","skipDays","day"]));Ls=Ue(ul,Tt);let al=Ls,Us,cl=zt(e,l(["channel","item"]));Us=Ae(cl,ja);let pl=Us;return new d(new ts(t,r,n,s,i,o,u,a,c,f,m,g,R,q,el,tl,sl,ll,al,pl))})))}function Ba(e){return b(be(e.root_element,l(["rss","channel"])),t=>b(le(e.root_element,"version"),r=>b(Ia(t),n=>new d(new es(r,n)))))}function ro(e){return b(to(e),t=>b(Ba(t),r=>new d(r)))}function ve(e){return e}function no(e){return e.replaceAll(/[><&"']/g,t=>{switch(t){case">":return"&gt;";case"<":return"&lt;";case"'":return"&#39;";case"&":return"&amp;";case'"':return"&quot;";default:return t}})}function so(e){return no(e)}function tr(e){return so(e)}var U$=!!globalThis.HTMLElement?.prototype?.moveBefore;var me=l([]);var La=new Xe,Ua=new P,Na=new H;function uo(e,t){return e.name===t.name?Na:e.name<t.name?Ua:La}var Fe=class extends ${constructor(t,r,n){super(),this.kind=t,this.name=r,this.value=n}};var Xa=0;function Ga(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head;if(s instanceof Fe){let i=s.name;if(i==="")e=r.tail,t=n;else if(i==="class"){let o=s.value;if(o==="")e=r.tail,t=n;else{let u=r.tail;if(u instanceof x){let a=s;e=u,t=p(a,n)}else{let a=u.head;if(a instanceof Fe)if(a.name==="class"){let f=s.kind,m=o,g=u.tail,y=a.value,v=m+" "+y,S=new Fe(f,"class",v);e=p(S,g),t=n}else{let f=s;e=u,t=p(f,n)}else{let c=s;e=u,t=p(c,n)}}}}else if(i==="style"){let o=s.value;if(o==="")e=r.tail,t=n;else{let u=r.tail;if(u instanceof x){let a=s;e=u,t=p(a,n)}else{let a=u.head;if(a instanceof Fe)if(a.name==="style"){let f=s.kind,m=o,g=u.tail,y=a.value,v=m+";"+y,S=new Fe(f,"style",v);e=p(S,g),t=n}else{let f=s;e=u,t=p(f,n)}else{let c=s;e=u,t=p(c,n)}}}}else{let o=s;e=r.tail,t=p(o,n)}}else{let i=s;e=r.tail,t=p(i,n)}}}}function ps(e){if(e instanceof x)return e;if(e.tail instanceof x)return e;{let n=wi(e,(s,i)=>uo(i,s));return Ga(n,me)}}function Gr(e,t){return new Fe(Xa,e,t)}function rr(e,t,r){let n;e!==""?n=p(Gr("data-lustre-key",e),r):n=r;let i=n,o;return t!==""?o=p(Gr("xmlns",t),i):o=i,vt(o,Wt(),(c,f)=>{if(f instanceof Fe){let m=f.name;if(m==="virtual:defaultValue"){let g=f.value;return Z(c,' value="'+tr(g)+'"')}else{if(m==="virtual:defaultChecked")return Z(c," checked");if(m==="virtual:defaultSelected")return Z(c," selected");if(m==="")return c;{let g=f.value;if(g==="")return Z(c," "+m);{let y=m,v=g;return Z(c," "+y+'="'+tr(v)+'"')}}}}else return c})}function _(e,t){return Gr(e,t)}function ue(e){return _("class",e)}function co(e,t){return _("data-"+e,t)}function fs(e){return _("id",e)}function at(e,t){return e===""||t===""?ue(""):_("style",e+":"+t+";")}function Ja(e,t){for(;;){let r=e,n=t;if(r instanceof x)return n;{let s=r.head[0];if(s==="")e=r.tail,t=n;else{let i=r.head[1];if(i==="")e=r.tail,t=n;else{let o=r.tail,u=s,a=i;e=o,t=n+u+":"+a+";"}}}}}function po(e){return _("style",Ja(e,""))}function Jr(e){return _("href",e)}function fo(e){return _("rel",e)}function $o(e){return _("src",e)}function mo(e){return _("crossorigin",e)}function _o(e){return _("action",e)}function xo(e){return _("method",e)}function ds(e){return _("name",e)}function ct(e){return _("type",e)}function $s(e){return _("value",e)}function ho(e){return _("content",e)}function wo(e){return _("charset",e)}function Va(e,t){return _("aria-"+e,t)}function jt(e){return Va("label",e)}function pt(){return null}function Vr(e,t,r){return e??=new Map,e.set(t,r),e}var ft=class extends ${constructor(t,r,n,s,i){super(),this.kind=t,this.key=r,this.mapper=n,this.children=s,this.keyed_children=i}};var Pe=class extends ${constructor(t,r,n,s,i,o,u,a,c,f){super(),this.kind=t,this.key=r,this.mapper=n,this.namespace=s,this.tag=i,this.attributes=o,this.children=u,this.keyed_children=a,this.self_closing=c,this.void=f}};var Ze=class extends ${constructor(t,r,n,s){super(),this.kind=t,this.key=r,this.mapper=n,this.content=s}};var nr=class extends ${constructor(t,r,n,s,i,o,u){super(),this.kind=t,this.key=r,this.mapper=n,this.namespace=s,this.tag=i,this.attributes=o,this.inner_html=u}};var ec=1,tc=2,rc=3;function sr(e,t){return t===""?e==="area"||e==="base"||e==="br"||e==="col"||e==="embed"||e==="hr"||e==="img"||e==="input"||e==="link"||e==="meta"||e==="param"||e==="source"||e==="track"?!0:e==="wbr":!1}function bo(e,t){return t instanceof ft?new ft(t.kind,e,t.mapper,t.children,t.keyed_children):t instanceof Pe?new Pe(t.kind,e,t.mapper,t.namespace,t.tag,t.attributes,t.children,t.keyed_children,t.self_closing,t.void):t instanceof Ze?new Ze(t.kind,e,t.mapper,t.content):new nr(t.kind,e,t.mapper,t.namespace,t.tag,t.attributes,t.inner_html)}function ir(e,t,r,n,s,i,o,u,a){return new Pe(ec,e,t,r,n,ps(s),i,o,u,a)}function vo(e,t,r){return new Ze(tc,e,t,r)}function ko(e,t,r,n,s,i){return new nr(rc,e,t,r,n,ps(s),i)}function yo(e,t){return vt(t,e,(r,n)=>{let i=_s(n);return(o=>Ve(r,o))(i)})}function _s(e){if(e instanceof ft){let t=e.children;return yo(Wt(),t)}else if(e instanceof Pe)if(e.self_closing){let r=e.key,n=e.namespace,s=e.tag,i=e.attributes,o="<"+s,u=rr(r,n,i),c=Ve(o,u);return Z(c,"/>")}else if(e.void){let n=e.key,s=e.namespace,i=e.tag,o=e.attributes,u="<"+i,a=rr(n,s,o),f=Ve(u,a);return Z(f,">")}else{let n=e.key,s=e.namespace,i=e.tag,o=e.attributes,u=e.children,a="<"+i,c=rr(n,s,o),m=Ve(a,c),g=Z(m,">"),y=yo(g,u);return Z(y,"</"+i+">")}else if(e instanceof Ze){let t=e.content;return t===""?Wt():tr(t)}else{let t=e.key,r=e.namespace,n=e.tag,s=e.attributes,i=e.inner_html,o="<"+n,u=rr(t,r,s),c=Ve(o,u),f=Z(c,">"),m=Z(f,i);return Z(m,"</"+n+">")}}function xs(e){let r=_s(e);return r}function M(e,t,r){return ir("",ve,"",e,t,r,pt(),!1,sr(e,""))}function Yr(e,t,r,n){return ir("",ve,e,t,r,n,pt(),!1,sr(t,e))}function Kr(e){return vo("",ve,e)}function hs(e,t,r,n){return ko("",ve,e,t,r,n)}function Ro(e){return xs(e)}function ws(e){let t=xs((()=>{if(e instanceof Pe){let r=e.tag;return r==="html"?e:r==="head"?M("html",l([]),l([e])):r==="body"?M("html",l([]),l([e])):M("html",l([]),l([M("body",l([]),l([e]))]))}else return M("html",l([]),l([M("body",l([]),l([e]))]))})());return(r=>Pt(`<!doctype html>
`,r))(t)}function dt(e){return{statusCode:e.status_code,headers:Object.fromEntries(e.headers.entries()),cookies:e.cookies.toArray(),body:e.body,isBase64Encoded:e.is_base64_encoded}}import*as So from"node:fs";function or(e){console.log(e)}function $t(e){console.error(e)}function ys(e){try{return new d(So.readFileSync(e,{encoding:"base64"}))}catch(t){return new h(t.message)}}var vs=class extends ${constructor(t,r,n,s,i,o,u,a,c){super(),this.version=t,this.raw_path=r,this.raw_query_string=n,this.cookies=s,this.headers=i,this.query_string_parameters=o,this.request_context=u,this.body=a,this.is_base64_encoded=c}};var ks=class extends ${constructor(t,r,n,s,i,o,u,a){super(),this.account_id=t,this.api_id=r,this.domain_name=n,this.domain_prefix=s,this.http=i,this.request_id=o,this.time=u,this.time_epoch=a}};var Es=class extends ${constructor(t,r,n,s,i){super(),this.method=t,this.path=r,this.protocol=n,this.source_ip=s,this.user_agent=i}};var lr=class extends ${constructor(t,r,n,s,i){super(),this.status_code=t,this.headers=r,this.cookies=n,this.body=s,this.is_base64_encoded=i}};function oc(){return N("method",O,e=>N("path",O,t=>N("protocol",O,r=>N("sourceIp",O,n=>N("userAgent",O,s=>gr(new Es(e,t,r,n,s)))))))}function lc(){return N("accountId",O,e=>N("apiId",O,t=>N("domainName",O,r=>N("domainPrefix",O,n=>N("http",oc(),s=>N("requestId",O,i=>N("time",O,o=>N("timeEpoch",kn,u=>gr(new ks(e,t,r,n,s,i,o,u))))))))))}function uc(){return N("version",O,e=>N("rawPath",O,t=>N("rawQueryString",O,r=>yr("cookies",l([]),ui(O),n=>N("headers",En(O,O),s=>yr("queryStringParameters",se(),En(O,O),i=>N("requestContext",lc(),o=>yr("body","",O,u=>N("isBase64Encoded",si,a=>gr(new vs(e,t,r,n,s,i,o,u,a)))))))))))}function Co(e){let t=Xt(e,uc());return jn(t,r=>($t("Decode error: "+nt(r)),"Failed to decode Lambda event"))}function ur(e){return new lr(200,wt(l([["Content-Type","text/html; charset=utf-8"]])),l([]),e,!1)}function Ao(e,t){return new lr(200,wt(l([["Content-Type",t]])),l([]),e,!0)}function zo(e,t){return new lr(t,e.headers,e.cookies,e.body,e.is_base64_encoded)}function Rs(e,t,r){return Sr(e,n=>{if(n instanceof d){let s=n[0];return r(s)}else{let s=n[0];return $t("Error: "+nt(s)),ie(new h(t))}})}function To(e,t,r){let n,s=Pn(t);return n=Rt(s,o=>new h(r)),Cr(l([e,n]))}function jo(){let e=Date.now(),t=e%1e3,r=t*1e6;return[(e-t)/1e3,r]}var ar=class extends ${constructor(t,r){super(),this.seconds=t,this.nanoseconds=r}};function $c(e){let t=1e9,r=qt(e.nanoseconds,t),n=e.nanoseconds-r,s=e.seconds+Lt(n,t);return r>=0?new ar(s,r):new ar(s-1,t+r)}function Io(){let e=jo(),t,r;return t=e[0],r=e[1],$c(new ar(t,r))}function Bo(e){let t=e.seconds,r=e.nanoseconds;return t+r/1e9}function Do(e,t){return M("html",e,t)}function He(e){return Kr(e)}function Oo(e,t){return M("head",e,t)}function qo(e){return M("link",e,me)}function Ss(e){return M("meta",e,me)}function Lo(e,t){return hs("","style",e,t)}function Uo(e,t){return M("title",e,l([He(t)]))}function No(e,t){return M("body",e,t)}function Wo(e,t){return M("header",e,t)}function Fo(e,t){return M("h1",e,t)}function Cs(e,t){return M("h2",e,t)}function et(e,t){return M("div",e,t)}function As(e,t){return M("p",e,t)}function zs(e,t){return M("a",e,t)}function Po(e,t){return M("span",e,t)}function cr(e,t){return hs("","script",e,t)}function It(e,t){return M("button",e,t)}function Ho(e,t){return M("form",e,t)}function Ts(e){return M("input",e,me)}function Ms(e,t){return M("details",e,t)}function js(e,t){return M("summary",e,t)}function xc(e,t,r){for(;;){let n=e,s=t,i=r;if(n instanceof x)return[s,C(i)];{let o=n.tail,u=n.head[0],a=n.head[1],c=bo(u,a),f;u===""?f=s:f=Vr(s,u,c);let m=f,g=p(c,i);e=o,t=m,r=g}}}function hc(e){return xc(e,pt(),me)}function wc(e,t,r){let n=hc(r),s,i;return s=n[0],i=n[1],ir("",ve,"",e,t,i,s,!1,sr(e,""))}function Is(e,t){return wc("div",e,t)}var Xo="http://www.w3.org/2000/svg";function Bt(e,t){return Yr(Xo,"svg",e,t)}function Q(e){return Yr(Xo,"path",e,me)}function Go(e){return Bt(p(_("stroke-linejoin","round"),p(_("stroke-linecap","round"),p(_("stroke-width","2"),p(_("stroke","currentColor"),p(_("fill","none"),p(_("viewBox","0 0 24 24"),p(_("height","24"),p(_("width","24"),e)))))))),l([Q(l([_("d","M10 11v6")])),Q(l([_("d","M14 11v6")])),Q(l([_("d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6")])),Q(l([_("d","M3 6h18")])),Q(l([_("d","M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2")]))]))}function Jo(e){return Bt(p(_("stroke-linejoin","round"),p(_("stroke-linecap","round"),p(_("stroke-width","2"),p(_("stroke","currentColor"),p(_("fill","none"),p(_("viewBox","0 0 24 24"),p(_("height","24"),p(_("width","24"),e)))))))),l([Q(l([_("d","m18 15-6-6-6 6")]))]))}function Vo(e){return Bt(p(_("stroke-linejoin","round"),p(_("stroke-linecap","round"),p(_("stroke-width","2"),p(_("stroke","currentColor"),p(_("fill","none"),p(_("viewBox","0 0 24 24"),p(_("height","24"),p(_("width","24"),e)))))))),l([Q(l([_("d","m6 9 6 6 6-6")]))]))}function Yo(e){return Bt(p(_("stroke-linejoin","round"),p(_("stroke-linecap","round"),p(_("stroke-width","2"),p(_("stroke","currentColor"),p(_("fill","none"),p(_("viewBox","0 0 24 24"),p(_("height","24"),p(_("width","24"),e)))))))),l([Q(l([_("d","M5 12h14")])),Q(l([_("d","M12 5v14")]))]))}function Ko(e){return Bt(p(_("stroke-linejoin","round"),p(_("stroke-linecap","round"),p(_("stroke-width","2"),p(_("stroke","currentColor"),p(_("fill","none"),p(_("viewBox","0 0 24 24"),p(_("height","24"),p(_("width","24"),e)))))))),l([Q(l([_("d","M12 2v2")])),Q(l([_("d","M14.837 16.385a6 6 0 1 1-7.223-7.222c.624-.147.97.66.715 1.248a4 4 0 0 0 5.26 5.259c.589-.255 1.396.09 1.248.715")])),Q(l([_("d","M16 12a4 4 0 0 0-4-4")])),Q(l([_("d","m19 5-1.256 1.256")])),Q(l([_("d","M20 12h2")]))]))}var Qo="feed-inputs";function Zo(e){return et(l([ue("feed")]),l([Cs(l([]),l([zs(l([Jr(e.channel.link)]),l([He(e.channel.title)])),et(l([ue("divider")]),l([]))])),et(l([ue("feed-items")]),Y(e.channel.items,t=>{let r,n=t.description,s=xt(n,"");r=wn(s,'"',"");let i=r;return Ms(l([ue("feed-item")]),l([js(l([ue("item-title")]),l([He((()=>{let o=t.title;return xt(o,"Untitled")})())])),As(l([ue("item-description")]),l([He(i+" "),zs((()=>{let o=ht(t.link,u=>l([Jr(u)]));return xt(o,l([]))})(),l([He("Read more")]))]))]))}))]))}function Bs(e){return As(l([at("color","red")]),l([He(e)]))}function vc(){return l([It(l([fs("theme-toggle"),_("onclick","toggleTheme()"),jt("Toggle Theme")]),l([Ko(l([]))])),cr(l([]),`
    function toggleTheme() {
      const userPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const currentTheme = document.documentElement.getAttribute('data-theme');
      let newTheme;

      if (!currentTheme) {
        newTheme = userPrefersDark ? 'light' : 'dark';
      } else {
        newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      }

      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    }

    document.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
      }
    });
    `)])}function kc(){return l([It(l([_("onclick","addFeedInput()"),ct("button"),at("margin-right","0.5em"),jt("Add Feed")]),l([Yo(l([]))])),cr(l([]),`
    function addFeedInput() {
      const form = document.getElementById('`+Qo+`');
      if (form) {
        const input = document.createElement('input');
        input.name = 'feed-url[]';
        form.appendChild(input);
      }
    }

    let h2Time = document.querySelector('h2[data-time]');
    h2Time.innerText = new Date(
      parseInt(h2Time.getAttribute('data-time')) * 1000
    ).toLocaleString(navigator.language, {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      weekday: 'long',
      hour: 'numeric',
      minute: 'numeric',
    });
    `)])}function Ec(e){return l([Is(l([fs(Qo)]),Y(e,t=>[t,et(l([]),l([Ts(l([ds("feed-url[]"),$s(t)])),It(l([jt("Move up"),ct("button"),_("onclick","moveFeedUp(event)")]),l([Jo(l([]))])),It(l([jt("Move down"),ct("button"),_("onclick","moveFeedDown(event)")]),l([Vo(l([]))])),It(l([jt("Remove"),ct("button"),_("onclick","removeFeed(event)")]),l([Go(l([]))]))]))])),cr(l([]),`
    function moveFeedUp(event) {
      const button = event.currentTarget;
      const div = button.parentElement;
      const container = div.parentElement;
      if (div.previousElementSibling) {
        container.insertBefore(div, div.previousElementSibling);
      }
    }

    function moveFeedDown(event) {
      const button = event.currentTarget;
      const div = button.parentElement;
      const container = div.parentElement;
      if (div.nextElementSibling) {
        container.insertBefore(div.nextElementSibling, div);
      }
    }

    function removeFeed(event) {
      const button = event.currentTarget;
      const div = button.parentElement;
      const container = div.parentElement;
      container.removeChild(div);
    }
    `)])}function Rc(e){return Ms(l([ue("sources")]),l([js(l([po(l([["font-weight","bold"],["opacity","0.6"]]))]),l([He("Sources")])),Ho(l([xo("GET"),_o("/")]),(()=>{let t=Ec(e),r=Ke(t,kc());return Ke(r,l([Ts(l([ct("submit"),$s("Save"),at("vertical-align","bottom")]))]))})())]))}function Ds(e,t){return Do(l([]),l([Oo(l([]),l([Ss(l([wo("UTF-8")])),Ss(l([ds("viewport"),ho("width=device-width, initial-scale=1.0")])),qo(l([fo("icon"),ct("image/x-icon"),Jr("/favicon.ico")])),Uo(l([]),"RSS Reader"),cr(l([$o("https://cdn.jsdelivr.net/npm/htmx.org@2.0.6/dist/htmx.min.js"),mo("anonymous")]),""),Lo(l([]),`
:root {
  --bg-color: seashell;
  --text-color: #222222;
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg-color: #222222;
    --text-color: seashell;
  }
}

[data-theme="dark"] {
  --bg-color: #222222;
  --text-color: seashell;
}

[data-theme="light"] {
  --bg-color: seashell;
  --text-color: #222222;
}

body {
  background: var(--bg-color);
  color: var(--text-color);
  transition: background 0.3s, color 0.3s;
  font-family: serif;
  margin: 0;
  padding: 1rem 6rem;
}

a {
  color: coral;
}

div:has(.loader) {
  text-align: center;
}

.loader {
  width: 24px;
  height: 24px;
  border: 3px solid currentColor;
  border-bottom-color: transparent;
  border-radius: 50%;
  display: inline-block;
  box-sizing: border-box;
  animation: rotation 1s linear infinite;
}

@keyframes rotation {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.feeds {
  display: flex;
  flex-flow: row nowrap;
  justify-content: space-around;
  align-items: flex-start;
  margin-top: 1em;
  column-gap: 2em;
  scroll-snap-type: x mandatory;
  overflow-x: auto;
  height: calc(100svh - 12rem);
}

.feed-container {
  width: min(clamp(50%, 400px, 100%), 600px);
  flex: 0 0 auto;
  scroll-snap-align: center;
}

.feed {
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
}

.feed h2 {
  text-transform: uppercase;
  display: flex;
  align-items: end;
  gap: 0.5em;
  margin-top: 0;
  margin-bottom: 1.25em;
  font-size: 1.4em;
}

.feed h2 a {
  color: color-mix(in oklab, currentColor 75%, coral);
}

.feed-items {
  display: flex;
  flex-direction: column;
  gap: 1.5em;
  overflow-y: auto;
  flex: 1;
}

.feed-items .feed-item:nth-child(even) {
  align-self: flex-end;
}
.feed-items .feed-item:nth-child(odd) {
  align-self: flex-start;
}
.feed-items .feed-item {
  width: 90%;
}

.feed-items .feed-item:first-of-type .item-title {
  font-size: 1.2em;
  width: 100%;
}

.item-description {
  font-size: smaller;
  opacity: 0.8;
  padding-left: 1em;
}

header {
  font-family: "Verdana", sans-serif;
}

header h1 {
  margin: 0 0 0.25rem;
  padding: 0.25rem;
  border-block: 4px double currentColor;
}

header h2 {
  margin: 0.25rem 0;
  padding: 0.5rem;
  font-size: 0.8rem;
  border-bottom: 1px solid currentColor;
  text-transform: uppercase;
}

summary.item-title {
  font-size: 0.9em;
  padding-left: 1em;
  border-left: 2px solid coral;
}

.sources {
  padding: 0.5rem;
  border-bottom: 1px solid color-mix(in oklab, currentColor 20%, transparent);
}

@media (max-width: 600px) {
  body {
    padding: 1rem 2rem;
  }
}

.sources form {
  margin: 1rem 0 0.5rem;
}

#feed-inputs {
  display:flex;
  flex-wrap: wrap;
  gap: 0.25em 0.5em;
  margin-bottom: 0.5em;
}

#feed-inputs > div {
  display: flex;
  align-items: center;
  gap: 0.25em;
}

#feed-inputs input {
  padding: 0.25em 1em 0.25em 0.5em;
  min-width: 200px;
  border-width: 0;
  border-left: 2px solid coral;
  background: color-mix(in oklab, var(--bg-color) 80%, var(--text-color));
  color: currentColor;
  text-overflow: ellipsis;
  flex-shrink: 1;
  min-width: 150px;
}

.sources button:has(svg) {
  font-size: 16px;
  width: 24px;
  height: 24px;
  padding: 4px;
}

.sources button svg {
  width: 1em;
  height: 1em;
}

.sources form input[type="submit"], .sources button {
  border: 0;
  border-radius: 0.5em;
  background: coral;
  cursor: pointer;
  box-shadow: 0 2px 3px #0006;
  padding: 0.2em 0.5em;
  font-size: 14px;
  color: #222222;
}

#theme-toggle {
  position: fixed;
  bottom: 1rem;
  right: 1rem;
  background: coral;
  border: none;
  border-radius: 50%;
  width: 3rem;
  height: 3rem;
  cursor: pointer;
}
`)])),No(l([]),p(Wo(l([]),l([Fo(l([at("text-align","center")]),l([He("RSS Reader")])),Cs(l([at("text-align","center"),co("time",(()=>{let r=Io(),n=Bo(r);return _r(n)})())]),l([]))])),p(et(l([at("margin-inline","1em")]),Y(t,r=>Bs(r))),p(Rc(e),p(Is(l([ue("feeds")]),Y(e,r=>[r,et(l([_("hx-get","/items?feed-url="+r),_("hx-trigger","load"),_("hx-target","this"),ue("feed-container")]),l([et(l([]),l([Po(l([ue("loader")]),l([]))]))]))])),vc())))))]))}function Cc(e){let t=zi(e);if(t instanceof d){let r=t[0];return or("Fetching feed from "+e),Rs(Di(r),"Error fetching URL: "+e,n=>Rs(Xn(n),"Error reading response body from URL: "+e,s=>ie(ro(s.body))))}else return ie(new h("Invalid URL: "+e))}function ex(e){let t,r=ys("./favicon.ico");t=Jt(r,"");let n=t;or("Received event: "+nt(e));let s=Co(e),i;if(s instanceof d){let u=s[0],a=u.request_context.http.path;if(a==="/"){let c,f=u.query_string_parameters,m=Ce(f,"feed-url[]"),g=Jt(m,""),y=xr(g,",");c=bt(y,U=>Ht(U)!=="");let S=Ds(c,l([])),R=ws(S),j=ur(R),I=dt(j);i=ie(I)}else if(a==="/items"){let c,f=u.query_string_parameters,m=Ce(f,"feed-url");c=Jt(m,"");let g=c;i=Rt((()=>{let y=Cc(g);return To(y,3e3,"Timeout fetching URL: "+g)})(),y=>{let v;if(y instanceof d){let I=y[0];v=Zo(I)}else{let I=y[0];v=Bs(I)}let R=Ro(v),j=ur(R);return dt(j)})}else if(a==="/favicon.ico"){let c=Ao(n,"image/x-icon"),f=dt(c);i=ie(f)}else{let c=ur("Not found"),f=zo(c,404),m=dt(f);i=ie(m)}}else{let u=s[0];$t(u);let a=Ds(l([]),l([u])),c=ws(a),f=ur(c),m=dt(f);i=ie(m)}let o=i;return Ti(o,u=>or("Returning response: "+nt(u))),o}export{ex as handler};
